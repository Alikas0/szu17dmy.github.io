> 在本章中，我们将对网络层的**转发（forwarding）**功能和**路由选择（routing）**功能做重要区分。转发涉及分组在*单一*的路由器中从一条入链路到一条出链路的传送。路由选择涉及一个网络的*所有*路由器，它们经路由选择协议共同交互，以决定分组从源到目的地结点所采用的路径。

## 4.1 概述
### 4.1.1 转发和路由选择
> 网络层的作用从表面上看极为简单，即将分组从一台发送主机移动到一台接收主机。为此，需要两种重要的网络层功能。
>
> + 转发。当一个分组到达路由器的一条输入链路时，路由器必须将该分组移动到适当的输出链路。
> + 路由选择。当分组从发送方流向接收方时，网络层必须决定这些分组所采用的路由或路径。计算这些路径的算法被称为**路由选择算法（routing algorithm）**。

> 用驾驶的例子进行类比，考虑在1.3.1节中旅行者所历经的从宾夕法尼亚州到佛罗里达州的行程。在这个行程中，该驾驶员到佛罗里达州经过了途中的许多立交桥。我们能够认为转发就像通过单个立交桥的过程：一辆汽车沿道路上进入立交桥的一个入口，并且决定应当走哪条路来离开该立交桥。我们能够认为路由选择是规划从费城到佛罗里达州行程的过程：在着手行程之前，驾驶员查阅地图并在许多可能的路径中选择其中一条，其中每条路径都由一系列经立交桥链接的路段组成。

> 每台路由器具有一张**转发表（forwarding table）**。路由器通过检查到达分组首部字段的值来转发分组，然后使用该值在该路由器的转发表中索引查询。

> 我们将约定术语*分组交换机*是指一台通用分组交换设备，它根据分组首部字段中的值，从输入链路接口到输出链路接口转移分组。某些分组交换机称为**链路层交换机（link-layer switches）**，基于链路层字段中的值做转发决定。其他分组交换机称为**路由器（router）**，基于网络层字段中的值做转发决定。市场销售资料经常将具有以太网接口的路由器称为”三层交换机“，但它们实际上是三层设备，混淆了相关概念。

#### 连接建立
> 但我们很快将看到在某些计算机网络中，实际上有第三种重要的网络功能，即**连接建立（connection setup）**。
>
> 以类似的方式，某些网络层体系结构如ATM、帧中继、MPLS，要求从源到目的地沿着所选择的路径彼此握手，以便在给定源到目的地连接中的网络层数据分组能够开始流动之前建立起状态。在网络层，该过程被称为*连接建立*。

### 4.1.2 网络服务模型
> **网络服务模型（network service model）**定义了分组在发送与接收端系统之间的端到端运输特性。

## 4.2 虚电路和数据报电路
> 仅在网络层提供连接服务的计算机网络成为**虚电路（Virtual-Circuit, VC）网络**；仅在网络层提供无连接服务的计算机网络称为**数据报网络（datagram network）**。











